{
  "created": 1756626087.5191581,
  "duration": 0.12880325317382812,
  "exitcode": 1,
  "root": "/Users/davidboaz/Documents/GitHub/gen_policy_validator",
  "environment": {},
  "summary": {
    "failed": 2,
    "total": 3,
    "collected": 3
  },
  "collectors": [
    {
      "nodeid": "",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py",
          "type": "Module",
          "lineno": null
        }
      ],
      "longrepr": null
    },
    {
      "nodeid": "eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py",
      "outcome": "passed",
      "result": [
        {
          "nodeid": "eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py::test_change_entire_reservation_cabin",
          "type": "Function",
          "lineno": 8
        },
        {
          "nodeid": "eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py::test_change_only_one_segment_raises",
          "type": "Function",
          "lineno": 51
        },
        {
          "nodeid": "eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py::test_mixed_cabin_classes_raises",
          "type": "Function",
          "lineno": 92
        }
      ],
      "longrepr": null
    }
  ],
  "tests": [
    {
      "nodeid": "eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py::test_change_entire_reservation_cabin",
      "lineno": 8,
      "outcome": "passed",
      "keywords": [
        "test_change_entire_reservation_cabin",
        "test_guard_cabin_change_payment_requirement.py",
        "update_reservation_flights",
        "tests",
        "2025-08-31_10_38_30",
        "output",
        "airline",
        "eval",
        "gen_policy_validator",
        ""
      ],
      "setup": {
        "duration": 0.0011516250669956207,
        "outcome": "passed"
      },
      "call": {
        "duration": 0.0009588748216629028,
        "outcome": "passed",
        "crash": null,
        "traceback": null,
        "longrepr": null
      },
      "user_properties": [
        {
          "docstring": "\n    Policy: Ensure a uniform cabin class change across all flights within the reservation and payment for the fare difference.\n    Example: A user changes the entire reservation's cabin class from economy to business, ensuring all flight segments are included and provides payment details to cover the fare difference.\n    "
        }
      ],
      "teardown": {
        "duration": 0.00013804202899336815,
        "outcome": "passed"
      }
    },
    {
      "nodeid": "eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py::test_change_only_one_segment_raises",
      "lineno": 51,
      "outcome": "failed",
      "keywords": [
        "test_change_only_one_segment_raises",
        "test_guard_cabin_change_payment_requirement.py",
        "update_reservation_flights",
        "tests",
        "2025-08-31_10_38_30",
        "output",
        "airline",
        "eval",
        "gen_policy_validator",
        ""
      ],
      "setup": {
        "duration": 0.00010312488302588463,
        "outcome": "passed"
      },
      "call": {
        "duration": 0.0013077082112431526,
        "outcome": "failed",
        "crash": {
          "path": "/Users/davidboaz/Documents/GitHub/gen_policy_validator/eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py",
          "lineno": 90,
          "message": "Failed: DID NOT RAISE <class 'rt_toolguard.data_types.PolicyViolationException'>"
        },
        "traceback": [
          {
            "path": "tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py",
            "lineno": 90,
            "message": "Failed"
          }
        ],
        "longrepr": "def test_change_only_one_segment_raises():\n        \"\"\"\n        Policy: Uniform cabin class change required across all flights.\n        Example: A user attempts to change only one segment of their reservation from economy to business class without updating the cabin class for the entire reservation.\n        \"\"\"\n    \n        reservation = Reservation(\n            reservation_id=\"ZFA04Y\",\n            user_id=\"user123\",\n            origin=\"SFO\",\n            destination=\"JFK\",\n            flight_type=\"round_trip\",\n            cabin=\"economy\",\n            flights=[\n                ReservationFlight(flight_number=\"HAT001\", origin=\"SFO\", destination=\"JFK\", date=\"2024-06-01\", price=200),\n                ReservationFlight(flight_number=\"HAT002\", origin=\"JFK\", destination=\"SFO\", date=\"2024-06-10\", price=200)\n            ],\n            passengers=[],\n            payment_history=[],\n            created_at=datetime.now().strftime(\"%Y-%m-%dT%H:%M:%S\"),\n            total_baggages=0,\n            nonfree_baggages=0,\n            insurance=\"no\",\n            status=None\n        )\n    \n        api = MagicMock(spec=I_Airline)\n        api.get_reservation_details.side_effect = lambda rid: reservation if rid == \"ZFA04Y\" else None\n        api.get_flight_instance.side_effect = lambda fn, date: FlightDateStatusAvailable(\n            status=\"available\",\n            available_seats={\"business\": 5, \"economy\": 5, \"basic_economy\": 5},\n            prices={\"business\": 400, \"economy\": 200, \"basic_economy\": 100}\n        ) if (fn, date) in [(\"HAT001\", \"2024-06-01\"), (\"HAT002\", \"2024-06-10\")] else None\n    \n        flights = [\n            FlightInfo(flight_number=\"HAT001\", date=\"2024-06-01\")\n        ]\n    \n>       with pytest.raises(PolicyViolationException):\nE       Failed: DID NOT RAISE <class 'rt_toolguard.data_types.PolicyViolationException'>\n\ntests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py:90: Failed"
      },
      "user_properties": [
        {
          "docstring": "\n    Policy: Uniform cabin class change required across all flights.\n    Example: A user attempts to change only one segment of their reservation from economy to business class without updating the cabin class for the entire reservation.\n    "
        }
      ],
      "teardown": {
        "duration": 0.00018974998965859413,
        "outcome": "passed"
      }
    },
    {
      "nodeid": "eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py::test_mixed_cabin_classes_raises",
      "lineno": 92,
      "outcome": "failed",
      "keywords": [
        "test_mixed_cabin_classes_raises",
        "test_guard_cabin_change_payment_requirement.py",
        "update_reservation_flights",
        "tests",
        "2025-08-31_10_38_30",
        "output",
        "airline",
        "eval",
        "gen_policy_validator",
        ""
      ],
      "setup": {
        "duration": 0.00010874960571527481,
        "outcome": "passed"
      },
      "call": {
        "duration": 0.0008241669274866581,
        "outcome": "failed",
        "crash": {
          "path": "/Users/davidboaz/Documents/GitHub/gen_policy_validator/eval/airline/output/2025-08-31_10_38_30/tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py",
          "lineno": 132,
          "message": "Failed: DID NOT RAISE <class 'rt_toolguard.data_types.PolicyViolationException'>"
        },
        "traceback": [
          {
            "path": "tests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py",
            "lineno": 132,
            "message": "Failed"
          }
        ],
        "longrepr": "def test_mixed_cabin_classes_raises():\n        \"\"\"\n        Policy: Uniform cabin class change required across all flights.\n        Example: A user updates their reservation to have mixed cabin classes, changing one flight to economy and another to business class.\n        \"\"\"\n    \n        reservation = Reservation(\n            reservation_id=\"ZFA04Y\",\n            user_id=\"user123\",\n            origin=\"SFO\",\n            destination=\"JFK\",\n            flight_type=\"round_trip\",\n            cabin=\"economy\",\n            flights=[\n                ReservationFlight(flight_number=\"HAT001\", origin=\"SFO\", destination=\"JFK\", date=\"2024-06-01\", price=200),\n                ReservationFlight(flight_number=\"HAT002\", origin=\"JFK\", destination=\"SFO\", date=\"2024-06-10\", price=200)\n            ],\n            passengers=[],\n            payment_history=[],\n            created_at=datetime.now().strftime(\"%Y-%m-%dT%H:%M:%S\"),\n            total_baggages=0,\n            nonfree_baggages=0,\n            insurance=\"no\",\n            status=None\n        )\n    \n        api = MagicMock(spec=I_Airline)\n        api.get_reservation_details.side_effect = lambda rid: reservation if rid == \"ZFA04Y\" else None\n        api.get_flight_instance.side_effect = lambda fn, date: FlightDateStatusAvailable(\n            status=\"available\",\n            available_seats={\"business\": 5, \"economy\": 5, \"basic_economy\": 5},\n            prices={\"business\": 400, \"economy\": 200, \"basic_economy\": 100}\n        ) if (fn, date) in [(\"HAT001\", \"2024-06-01\"), (\"HAT002\", \"2024-06-10\")] else None\n    \n        flights = [\n            FlightInfo(flight_number=\"HAT001\", date=\"2024-06-01\"),\n            FlightInfo(flight_number=\"HAT002\", date=\"2024-06-10\")\n        ]\n    \n>       with pytest.raises(PolicyViolationException):\nE       Failed: DID NOT RAISE <class 'rt_toolguard.data_types.PolicyViolationException'>\n\ntests/update_reservation_flights/test_guard_cabin_change_payment_requirement.py:132: Failed"
      },
      "user_properties": [
        {
          "docstring": "\n    Policy: Uniform cabin class change required across all flights.\n    Example: A user updates their reservation to have mixed cabin classes, changing one flight to economy and another to business class.\n    "
        }
      ],
      "teardown": {
        "duration": 0.00014029210433363914,
        "outcome": "passed"
      }
    }
  ]
}