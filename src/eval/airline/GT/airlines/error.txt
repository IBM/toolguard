             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
[05/07/25 23:39:34] INFO     Provider azure API load: 18 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
[05/07/25 23:39:34] INFO     b771bc6e-875b-4a23-98d gen_tool_policy_check.py:151
                             e-e987ec7f1ae6                                     
                             tool_information_depen                             
                             dencies(tool_name='Fli                             
                             ght Cancellation                                   
                             Segment Rule',                                     
                             policy="Agents can                                 
                             only cancel entire                                 
                             reservations if all                                
                             flight segments in the                             
                             reservation have not                               
                             been flown. A                                      
                             reservation cannot be                              
                             canceled by the agent                              
                             if any segment is                                  
                             marked as 'flying' or                              
                             'landed'; in such                                  
                             cases, the user must                               
                             be transferred to a                                
                             human agent for                                    
                             further assistance.",                              
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 19 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     ed0dbeeb-cfe8-4595-8fe gen_tool_policy_check.py:151
                             3-ffa54ff0074e                                     
                             tool_information_depen                             
                             dencies(tool_name='Hum                             
                             an Agent Transfer                                  
                             Limitation',                                       
                             policy='Transfer the                               
                             user to a human agent                              
                             if and only if the                                 
                             request cannot be                                  
                             resolved with the                                  
                             available tools,                                   
                             specifically when                                  
                             issues cannot be                                   
                             addressed using the                                
                             current toolset or                                 
                             when a user requests a                             
                             human agent.',                                     
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 20 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     fe03d97d-6b63-484a-b39 gen_tool_policy_check.py:151
                             c-78dee0191b50                                     
                             tool_information_depen                             
                             dencies(tool_name='Exp                             
                             licit User                                         
                             Confirmation for                                   
                             Booking, Modifying,                                
                             Upgrading, Editing and                             
                             Updating',                                         
                             policy='Before taking                              
                             any actions that                                   
                             update the booking                                 
                             database (booking,                                 
                             modifying flights,                                 
                             editing baggage,                                   
                             upgrading cabin class,                             
                             or updating passenger                              
                             information), you must                             
                             list the action                                    
                             details and obtain                                 
                             explicit user                                      
                             confirmation (yes) to                              
                             proceed.',                                         
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 21 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     f2b340ce-90ab-4982-96e gen_tool_policy_check.py:151
                             d-303af955dff1                                     
                             tool_information_depen                             
                             dencies(tool_name='Add                             
                              But Not Remove                                    
                             Baggage',                                          
                             policy='Ensure that                                
                             when updating baggage                              
                             information using                                  
                             ToolX, the number of                               
                             checked bags can only                              
                             be increased but not                               
                             decreased. Verify                                  
                             registration and                                   
                             baggage details to                                 
                             comply with this                                   
                             restriction before                                 
                             proceeding with any                                
                             updates.',                                         
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 22 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     bf685504-35cf-4085-a63 gen_tool_policy_check.py:151
                             3-fec709246a83                                     
                             tool_information_depen                             
                             dencies(tool_name='Tra                             
                             nsfer to Human Agent                               
                             Policy', policy="Users                             
                             should be transferred                              
                             to a human agent only                              
                             when ToolX (which                                  
                             encompasses tools for                              
                             booking, modifying, or                             
                             canceling reservations                             
                             and handling refunds)                              
                             is unable to resolve                               
                             the user's issue.                                  
                             Transfers should not                               
                             occur unless its                                  
                             confirmed that no                                  
                             available automated                                
                             solutions can address                              
                             the user's need.",                                 
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 23 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     641bb730-c1bb-4f80-b3e gen_tool_policy_check.py:151
                             3-bf1d2e2dc7fe                                     
                             tool_information_depen                             
                             dencies(tool_name='Com                             
                             pensation Eligibility                              
                             for Cancelled                                      
                             Flights', policy='To                               
                             compensate users for                               
                             cancelled flights, the                             
                             agent should use ToolX                             
                             to issue compensation                              
                             certificates. To                                   
                             qualify, users must be                             
                             a silver or gold                                   
                             member, have purchased                             
                             travel insurance, or                               
                             be flying business                                 
                             class. The agent must                              
                             verify both                                        
                             eligibility and flight                             
                             cancellation before                                
                             issuing the                                        
                             certificate,                                       
                             calculated at $100                                 
                             times the passenger                                
                             count.',                                           
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 24 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     0fd0bf94-b2c4-4fa8-b84 gen_tool_policy_check.py:151
                             a-10c4c05d0162                                     
                             tool_information_depen                             
                             dencies(tool_name='Act                             
                             ion Confirmation                                   
                             Requirement',                                      
                             policy="Before using                               
                             openapi for actions                                
                             like booking flights                               
                             or modifying                                       
                             reservations, the                                  
                             agent must clearly                                 
                             present all details of                             
                             the intended actions                               
                             to the user and wait                               
                             for explicit                                       
                             confirmation ('yes')                               
                             from the user before                               
                             proceeding.",                                      
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 25 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     9fdf5540-fd80-442a-a7c gen_tool_policy_check.py:151
                             c-b2867b76b65a                                     
                             tool_information_depen                             
                             dencies(tool_name='Tra                             
                             nsfer to Human Agent                               
                             Only If Necessary',                                
                             policy='Transfer users                             
                             to human agents only                               
                             when absolutely                                    
                             necessary, after                                   
                             confirming that all                                
                             actions pertaining to                              
                             booking, modifying,                                
                             canceling                                          
                             reservations, and                                  
                             sending certificates                               
                             cannot be completed                                
                             using available tools.                             
                             The agent must ensure                              
                             that all tool                                      
                             functionalities have                               
                             been utilized before                               
                             deciding on a                                      
                             transfer.',                                        
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 26 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     2f342497-55f6-484f-8da gen_tool_policy_check.py:151
                             f-1abe26adccb5                                     
                             tool_information_depen                             
                             dencies(tool_name='Tra                             
                             nsfer to Human Agent                               
                             Policy',                                           
                             policy="Transfer users                             
                             to human agents only                               
                             when TauBench Airline                              
                             tool cannot process                                
                             the request using its                              
                             functionalities such                               
                             as booking, modifying,                             
                             or cancelling flights.                             
                             During the transfer,                               
                             provide a detailed                                 
                             summary of the user's                              
                             issue to ensure smooth                             
                             communication.",                                   
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
[05/07/25 23:39:35] INFO     Provider azure API load: 27 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
[05/07/25 23:39:35] INFO     f1961e05-4fb4-4803-a7f gen_tool_policy_check.py:151
                             9-9859e1f89ff2                                     
                             tool_information_depen                             
                             dencies(tool_name='Pas                             
                             senger Modification                                
                             Policy', policy="The                               
                             'update_reservation_pa                             
                             ssengers' tool allows                              
                             users to modify                                    
                             individual passenger                               
                             details within a                                   
                             reservation, like                                  
                             names or dates of                                  
                             birth. However, this                               
                             tool does not permit                               
                             changes to the total                               
                             number of passengers,                              
                             and this restriction                               
                             is non-negotiable even                             
                             if human intervention                              
                             is needed.",                                       
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 28 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     27a52166-144c-4e31-baf gen_tool_policy_check.py:151
                             d-1a98e3aa04bd                                     
                             tool_information_depen                             
                             dencies(tool_name='Ful                             
                             l Trip Cancellation                                
                             Policy',                                           
                             policy='Ensure that                                
                             before using the tool                              
                             to cancel flights, no                              
                             flight segment of the                              
                             trip has been flown.                               
                             If any segments have                               
                             been utilized,                                     
                             cancellation cannot                                
                             proceed and the user                               
                             must be transferred to                             
                             a human agent for                                  
                             assistance.',                                      
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 29 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     bf826cb2-ca78-4300-bc1 gen_tool_policy_check.py:151
                             b-0db07a35085f                                     
                             tool_information_depen                             
                             dencies(tool_name='Tra                             
                             nsfer to Human Agent                               
                             Conditional',                                      
                             policy="The agent must                             
                             transfer the user to a                             
                             human agent when the                               
                             user's request cannot                              
                             be resolved with the                               
                             available tools or if                              
                             the user explicitly                                
                             asks for human                                     
                             assistance. During                                 
                             transfer, a summary of                             
                             the user's issue must                              
                             be provided.",                                     
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 30 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     76f2d8a2-dea8-44d0-91e gen_tool_policy_check.py:151
                             6-cf61e98780dd                                     
                             tool_information_depen                             
                             dencies(tool_name='Avo                             
                             id Simultaneous Tool                               
                             and User Interaction',                             
                             policy='In the context                             
                             of TauBench Airline                                
                             operations, ensure                                 
                             that no simultaneous                               
                             tasks are performed                                
                             between tool actions                               
                             and user responses to                              
                             prevent any disruption                             
                             in service.                                        
                             Specifically, do not                               
                             make tool calls while                              
                             interacting with users                             
                             and vice versa. This                               
                             involves coordination                              
                             wherein only one                                   
                             process occurs at a                                
                             time without                                       
                             overlaps.',                                        
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
                    INFO     Provider azure API load: 31 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            
                    INFO     854307c7-1503-438d-a89 gen_tool_policy_check.py:151
                             5-ca9621a425a0                                     
                             tool_information_depen                             
                             dencies(tool_name='Fli                             
                             ght Modification                                   
                             Restriction for Basic                              
                             Economy', policy="When                             
                             using the                                          
                             'update_reservation_fl                             
                             ights' tool, ensure                                
                             that Basic economy                                 
                             flights are not                                    
                             modified. For other                                
                             flight categories,                                 
                             confirm that the                                   
                             origin, destination,                               
                             and trip type remain                               
                             unchanged. Retained                                
                             segments will have                                 
                             fixed prices from the                              
                             original booking and                               
                             will not update. These                             
                             conditions need manual                             
                             verification, as the                               
                             tool does not                                      
                             automatically check                                
                             them.",                                            
                             domain=FileTwin(file                             
                             _name='my_app/domain.p                             
                             y', content='#                                     
                             generated by                                       
                             datamodel-codegen:\n#                              
                             filename:                                          
                             airline.json\n#                                    
                             timestamp:                                         
                             2025-05-07T20:39:29+00                             
                             :00\n\nfrom __future__                             
                             import                                             
                             annotations\n\nfrom                                
                             datetime import date                               
                             as date_aliased\nfrom                              
                             datetime import                                    
                             datetime\nfrom typing                              
                             import Any, Dict,                                  
                             List, Literal,                                     
                             Optional\n\nfrom                                   
                             pydantic import                                    
                             BaseModel, RootModel,                              
                             confloat, conint,                                  
                             constr\n\n\nclass                                  
                             Name(BaseModel):\n                                 
                             first_name:                                        
                             Optional[str] = None\n                             
                             last_name:                                         
                             Optional[str] =                                    
                             None\n\n\nclass                                    
                             Address(BaseModel):\n                              
                             address1:                                          
                             Optional[str] = None\n                             
                             address2:                                          
                             Optional[str] = None\n                             
                             city: Optional[str] =                              
                             None\n    country:                                 
                             Optional[str] = None\n                             
                             province:                                          
                             Optional[str] = None\n                             
                             zip: Optional[str] =                               
                             None\n\n\nclass                                    
                             PaymentMethods(BaseMod                             
                             el):\n    source:                                  
                             Literal[\'credit_card\                             
                             ', \'certificate\',                                
                             \'gift_card\']\n                                   
                             """\n    Payment                                   
                             method source type.\n                              
                             """\n    brand:                                    
                             Optional[str] = None\n                             
                             """\n    Brand of the                              
                             payment method (e.g.,                              
                             Visa, MasterCard,                                  
                             etc.).\n    """\n                                  
                             last_four:                                         
                             Optional[constr(patter                             
                             n=r\'^[0-9]{4}$\')] =                              
                             None\n    """\n                                    
                             Last four digits of                                
                             the payment method.\n                              
                             """\n    id: str\n                                 
                             """\n    Unique                                    
                             identifier for the                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Payment(BaseModel):\n                              
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n                                      
                             amount: float\n                                    
                             """\n    The amount to                             
                             be paid.\n                                         
                             """\n\n\nclass                                     
                             Passenger(BaseModel):\                             
                             n    first_name: str\n                             
                             """\n    The first                                 
                             name of the passenger,                             
                             such as \'Noah\'.\n                                
                             """\n    last_name:                                
                             str\n    """\n    The                              
                             last name of the                                   
                             passenger, such as                                 
                             \'Brown\'.\n    """\n                              
                             dob: str\n    """\n                                
                             The date of birth of                               
                             the passenger in the                               
                             format \'YYYY-MM-DD\',                             
                             such as                                            
                             \'1990-01-01\'.\n                                  
                             """\n\n\nclass                                     
                             ScheduledFlight(BaseMo                             
                             del):\n                                            
                             flight_number: str\n                               
                             """\n                                              
                             ScheduledFlight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             origin: str\n    """\n                             
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination: str\n                                 
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             scheduled_departure_ti                             
                             me_est: str\n    """\n                             
                             Estimated scheduled                                
                             detaprture time in                                 
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n                                              
                             scheduled_arrival_time                             
                             _est: str\n    """\n                               
                             Estimated scheduled                                
                             arrival time in                                    
                             HH:MM:SS format                                    
                             (24-hour clock).\n                                 
                             """\n\n\nclass                                     
                             FlightPrices(BaseModel                             
                             ):\n    """\n    Price                             
                             per seat in different                              
                             classes.\n    """\n\n                              
                             basic_economy:                                     
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             economy:                                           
                             Optional[confloat(ge=0                             
                             .0)] = None\n                                      
                             business:                                          
                             Optional[confloat(ge=0                             
                             .0)] = None\n\n\nclass                             
                             FlightSeats(BaseModel)                             
                             :\n    """\n    Number                             
                             of available seats per                             
                             class.\n    """\n\n                                
                             basic_economy:                                     
                             Optional[conint(ge=0)]                             
                             = None\n    economy:                               
                             Optional[conint(ge=0)]                             
                             = None\n    business:                              
                             Optional[conint(ge=0)]                             
                             = None\n\n\nclass                                  
                             FlightInstanceId(BaseM                             
                             odel):\n                                           
                             flight_number: str\n                               
                             """\n    Flight                                    
                             number, such as                                    
                             \'HAT001\'.\n    """\n                             
                             date: str\n    """\n                               
                             The date for the                                   
                             flight in the format                               
                             \'YYYY-MM-DD\', such                               
                             as \'2024-05-01\'.\n                               
                             """\n\n\nclass                                     
                             FlightInstance(FlightI                             
                             nstanceId):\n                                      
                             status:                                            
                             Literal[\'landed\',                                
                             \'available\',                                     
                             \'cancelled\',                                     
                             \'flying\']\n                                      
                             actual_departure_time_                             
                             est:                                               
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated actual                                   
                             departure time in ISO                              
                             8601 format                                        
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             estimated_arrival_time                             
                             _est:                                              
                             Optional[datetime] =                               
                             None\n    """\n                                    
                             Estimated arrival time                             
                             in ISO 8601 format                                 
                             (YYYY-MM-DDTHH:MM:SS).                             
                             \n    """\n                                        
                             available_seats:                                   
                             Optional[FlightSeats]                              
                             = None\n    prices:                                
                             Optional[FlightPrices]                             
                             = None\n\n\nclass                                  
                             FoundFlight(ScheduledF                             
                             light):\n                                          
                             available_seats:                                   
                             FlightSeats\n                                      
                             prices:                                            
                             FlightPrices\n\n\nclas                             
                             s                                                  
                             ReservationFlight(Flig                             
                             htInstanceId):\n                                   
                             origin: Optional[str]                              
                             = None\n    """\n                                  
                             The IATA code for the                              
                             origin city, such as                               
                             \'SFO\'.\n    """\n                                
                             destination:                                       
                             Optional[str] = None\n                             
                             """\n    The IATA code                             
                             for the destination                                
                             city, such as                                      
                             \'JFK\'.\n    """\n                                
                             price: Optional[float]                             
                             = None\n    """\n                                  
                             The flight leg\n                                   
                             """\n\n\nclass                                     
                             CalculateParametersQue                             
                             ry(BaseModel):\n                                   
                             expression:                                        
                             str\n\n\nclass                                     
                             UpdateReservationBagga                             
                             gesRequest(BaseModel):                             
                             \n    total_baggages:                              
                             int\n    """\n    The                              
                             total number of                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of non-free                                 
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    payment_id:                               
                             str\n    """\n    The                              
                             payment id stored in                               
                             user profile, such as                              
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationFligh                             
                             tsRequest(BaseModel):\                             
                             n    cabin:                                        
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    flights:                                  
                             List[FlightInstanceId]                             
                             \n    """\n    An                                  
                             array of objects                                   
                             containing details                                 
                             about each flight leg                              
                             in the ENTIRE new                                  
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n    """\n                                  
                             payment_id: str\n                                  
                             """\n    The payment                               
                             id stored in user                                  
                             profile, such as                                   
                             \'credit_card_7815826\                             
                             ',                                                 
                             \'gift_card_7815826\',                             
                             \'certificate_7815826\                             
                             '.\n    """\n\n\nclass                             
                             UpdateReservationPasse                             
                             ngersRequest(BaseModel                             
                             ):\n    passengers:                                
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             flight leg in the                                  
                             ENTIRE new                                         
                             reservation. Even if                               
                             the a flight segment                               
                             is not changed, it                                 
                             should still be                                    
                             included in the                                    
                             array.\n                                           
                             """\n\n\nclass                                     
                             SearchDirectFlightPara                             
                             metersQuery(BaseModel)                             
                             :\n    origin:                                     
                             Optional[str] = None\n                             
                             destination:                                       
                             Optional[str] = None\n                             
                             date:                                              
                             Optional[date_aliased]                             
                             = None\n\n\nclass                                  
                             SearchDirectFlightResp                             
                             onse(RootModel[List[Fo                             
                             undFlight]]):\n                                    
                             root:                                              
                             List[FoundFlight]\n\n\                             
                             nSearchOnestopFlightPa                             
                             rametersQuery =                                    
                             SearchDirectFlightPara                             
                             metersQuery\n\n\nclass                             
                                                                                
                             SearchOnestopFlightRes                             
                             ponse(RootModel[List[L                             
                             ist[FoundFlight]]]):\n                             
                                 root:                                          
                             List[List[FoundFlight]                             
                             ]\n\n\nclass                                       
                             ListAirportsResponse(R                             
                             ootModel[List[Dict[str                             
                             , Any]]]):\n    root:                              
                             List[Dict[str,                                     
                             Any]]\n\n\nclass                                   
                             SendCertificateParamet                             
                             ersQuery(BaseModel):\n                             
                                 amount:                                        
                             float\n\n\nclass                                   
                             ThinkRequest(BaseModel                             
                             ):\n    thought: str\n                             
                             """\n    A thought to                              
                             think about.\n                                     
                             """\n\n\nclass                                     
                             TransferToHumanAgentsR                             
                             equest(BaseModel):\n                               
                               summary: str\n                                   
                             """\n    A summary of                              
                             the user\'s issue.\n                               
                             """\n\n\nclass                                     
                             User(BaseModel):\n                                 
                             name: Name\n                                       
                             address:                                           
                             Optional[Address] =                                
                             None\n    email: str\n                             
                             dob:                                               
                             Optional[date_aliased]                             
                             = None\n    """\n                                  
                             Date of birth\n                                    
                             """\n                                              
                             payment_methods:                                   
                             Optional[Dict[str,                                 
                             PaymentMethods]] =                                 
                             None\n    """\n    A                               
                             collection of payment                              
                             methods, keyed by                                  
                             unique identifiers.\n                              
                             """\n                                              
                             saved_passengers:                                  
                             Optional[List[Passenge                             
                             r]] = None\n                                       
                             membership:                                        
                             Literal[\'regular\',                               
                             \'silver\',                                        
                             \'gold\']\n                                        
                             reservations:                                      
                             Optional[List[str]] =                              
                             None\n    """\n                                    
                             List of associated                                 
                             reservation ids\n                                  
                             """\n\n\nclass                                     
                             ReservationBase(BaseMo                             
                             del):\n    user_id:                                
                             str\n    """\n    The                              
                             ID of the user to book                             
                             the reservation, such                              
                             as \'sara_doe_496\'.\n                             
                             """\n    origin: str\n                             
                             """\n    The IATA code                             
                             for the origin city,                               
                             such as \'SFO\'.\n                                 
                             """\n    destination:                              
                             str\n    """\n    The                              
                             IATA code for the                                  
                             destination city, such                             
                             as \'JFK\'.\n    """\n                             
                             flight_type:                                       
                             Literal[\'one_way\',                               
                             \'round_trip\']\n                                  
                             cabin:                                             
                             Literal[\'basic_econom                             
                             y\', \'economy\',                                  
                             \'business\']\n                                    
                             """\n    A cabin\n                                 
                             """\n    passengers:                               
                             List[Passenger]\n                                  
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             passenger.\n    """\n                              
                             total_baggages: int\n                              
                             """\n    The total                                 
                             number of baggage                                  
                             items included in the                              
                             reservation.\n                                     
                             """\n                                              
                             nonfree_baggages:                                  
                             int\n    """\n    The                              
                             number of payed                                    
                             baggage items included                             
                             in the reservation.\n                              
                             """\n    insurance:                                
                             Literal[\'yes\',                                   
                             \'no\']\n\n\nclass                                 
                             CreateReservation(Rese                             
                             rvationBase):\n                                    
                             flights:                                           
                             List[FlightInstanceId]                             
                             \n    """\n    flight                              
                             legs.\n    """\n                                   
                             payment_methods:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about each                                 
                             payment method.\n                                  
                             """\n\n\nclass                                     
                             Reservation(Reservatio                             
                             nBase):\n                                          
                             reservation_id:                                    
                             Optional[str] = None\n                             
                             """\n    The                                       
                             reservation ID, such                               
                             as \'ZFA04Y\'.\n                                   
                             """\n    flights:                                  
                             List[ReservationFlight                             
                             ]\n    """\n    An                                 
                             array of objects                                   
                             containing details                                 
                             about flight legs.\n                               
                             """\n                                              
                             payment_history:                                   
                             List[Payment]\n                                    
                             """\n    An array of                               
                             objects containing                                 
                             details about flight                               
                             legs.\n    """\n                                   
                             created_at: datetime\n                             
                             """\n    Timestamp                                 
                             indicating when the                                
                             entity was created, in                             
                             ISO 8601 format.\n                                 
                             """\n    status:                                   
                             Optional[Literal[\'can                             
                             celled\']] =                                       
                             None\n\n\n# Tool                                   
                             interfaces\nfrom                                   
                             typing import Any,                                 
                             Dict, List,                                        
                             Protocol\n\n\nclass                                
                             TaubenchAirline(Protoc                             
                             ol):\n\n    def                                    
                             calculate(self, query:                             
                             CalculateParametersQue                             
                             ry) ->str:\n                                       
                             """Calculate the                                   
                             result of a                                        
                             mathematical                                       
                             expression."""\n                                   
                             pass\n\n    def                                    
                             book_reservation(self,                             
                             request:                                           
                             CreateReservation)                                 
                             ->Reservation:\n                                   
                             """Creates a                                       
                             reservation"""\n                                   
                             pass\n\n    def                                    
                             get_reservation_detail                             
                             s(self,                                            
                             reservation_id: str)                               
                             ->Reservation:\n                                   
                             """Get the                                         
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             cancel_reservation(sel                             
                             f, reservation_id:                                 
                             str) ->Reservation:\n                              
                             """Cancel the whole                                
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_bag                             
                             gages(self,                                        
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationBagga                             
                             gesRequest)                                        
                             ->Reservation:\n                                   
                             """Update the baggage                              
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_fli                             
                             ghts(self,                                         
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationFligh                             
                             tsRequest)                                         
                             ->Reservation:\n                                   
                             """Update the flight                               
                             information of a                                   
                             reservation."""\n                                  
                             pass\n\n    def                                    
                             update_reservation_pas                             
                             sengers(self,                                      
                             reservation_id: str,                               
                             request:\n                                         
                             UpdateReservationPasse                             
                             ngersRequest)                                      
                             ->Reservation:\n                                   
                             """Update the                                      
                             passenger information                              
                             of a reservation."""\n                             
                             pass\n\n    def                                    
                             get_scheduled_flight(s                             
                             elf, flight_id: str)                               
                             ->ScheduledFlight:\n                               
                             """Get the details of                              
                             a scheduled flight.                                
                             For example, returns                               
                             the flight origin,                                 
                             destination, scheduled                             
                             detaprture and arrival                             
                             times."""\n                                        
                             pass\n\n    def                                    
                             search_direct_flight(s                             
                             elf, query:                                        
                             SearchDirectFlightPara                             
                             metersQuery\n        )                             
                             ->List[FoundFlight]:\n                             
                             """Search direct                                   
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             search_onestop_flight(                             
                             self, query:                                       
                             SearchOnestopFlightPar                             
                             ametersQuery\n                                     
                             )                                                  
                             ->List[List[FoundFligh                             
                             t]]:\n                                             
                             """Search one-stop                                 
                             flights between two                                
                             cities on a specific                               
                             date."""\n                                         
                             pass\n\n    def                                    
                             get_flight_instance(se                             
                             lf, flight_id: str,                                
                             date: datetime.date\n                              
                             ) ->FlightInstance:\n                              
                             """Get the details of                              
                             a flight instance in a                             
                             specific date. For                                 
                             example, returns the                               
                             flight status,                                     
                             available seats and                                
                             prices."""\n                                       
                             pass\n\n    def                                    
                             list_airports(self)                                
                             ->List[Any]:\n                                     
                             """List all airports                               
                             available in the                                   
                             system"""\n                                        
                             pass\n\n    def                                    
                             get_user_details(self,                             
                             user_id: str)                                      
                             ->User:\n                                          
                             """Get the details of                              
                             an user."""\n                                      
                             pass\n\n    def                                    
                             send_certificate(self,                             
                             user_id: str, query:\n                             
                             SendCertificateParamet                             
                             ersQuery) ->str:\n                                 
                             """Send a certificate                              
                             to a user. Be                                      
                             careful!"""\n                                      
                             pass\n\n    def                                    
                             think(self, request:                               
                             ThinkRequest) ->str:\n                             
                             """Use the tool to                                 
                             think about something.                             
                             It will not obtain new                             
                             information or change                              
                             the database, but just                             
                             append the thought to                              
                             the log. Use it when                               
                             complex reasoning is                               
                             needed."""\n                                       
                             pass\n\n    def                                    
                             transfer_to_human_agen                             
                             ts(self, request:                                  
                             TransferToHumanAgentsR                             
                             equest\n        )                                  
                             ->str:\n                                           
                             """Transfer the user                               
                             to a human agent, with                             
                             a summary of the                                   
                             user\'s issue. Only                                
                             transfer if the user                               
                             explicitly asks for a                              
                             human agent, or if the                             
                             user\'s issue cannot                               
                             be resolved by the                                 
                             agent with the                                     
                             available tools."""\n                              
                             pass\n\n'))                                        
[05/07/25 23:39:36] INFO     Provider azure API load: 32 requests   engine.py:81
                             current being processed by api and 0               
                             requests in queue waiting to be sent               
                             to api.                                            

Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py:1984: RuntimeWarning: coroutine 'AzureChatCompletion.acompletion' was never awaited
  handle = self._ready.popleft()
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.


Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.

unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-20' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-31' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-6' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-42' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-17' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-32' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-8' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-12' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-43' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-21' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-18' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-33' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-4' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-3' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-44' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-22' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-34' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-16' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-45' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-23' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-35' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-13' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-46' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-24' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-36' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-30' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-47' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-25' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-37' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-14' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-26' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-5' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-38' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-2' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-10' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-27' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-11' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-39' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-28' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-9' coro=<ToolCheckPolicyGenerator.generate() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:126> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 133, in generate
    items_tests = await asyncio.gather(* [
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-40' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-19' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-29' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-41' coro=<ToolCheckPolicyGenerator.generate_tool_item_tests_and_check_fn() done, defined at /Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py:144> exception=litellm.APIError: AzureException APIError - >
Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 412, in acompletion
    headers, response = await self.make_azure_openai_chat_completion_request(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/logging_utils.py", line 135, in async_wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 165, in make_azure_openai_chat_completion_request
    raw_response = await azure_client.chat.completions.with_raw_response.create(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_legacy_response.py", line 381, in wrapped
    return cast(LegacyAPIResponse[R], await func(*args, **kwargs))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 2032, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1805, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1495, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_base_client.py", line 1515, in _request
    self._platform = await asyncify(get_platform)()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 84, in wrapper
    return await to_thread(function, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/openai/_utils/_sync.py", line 45, in to_thread
    return await _asyncio_to_thread(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 507, in acompletion
    response = await init_response
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/llms/azure/azure.py", line 452, in acompletion
    raise AzureOpenAIError(status_code=500, message=str(e))
litellm.llms.azure.common_utils.AzureOpenAIError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 145, in generate_tool_item_tests_and_check_fn
    tests = await self.generate_tool_item_tests(item, check_fn)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 151, in generate_tool_item_tests
    dep_tools = await prompts.tool_information_dependencies(item.name, item.description, self.domain)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 176, in __call__
    output = await self.generate(call.inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/base.py", line 163, in generate
    response: Step[R] = await self.engine.generate_async(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/engine.py", line 84, in generate_async
    result = await asyncio.wait_for( self.engine.generate_async(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/programmatic-ai/src/programmatic_ai/inference/providers/azure/litellm.py", line 42, in generate_async
    completion = await litellm.acompletion(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1461, in wrapper_async
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/utils.py", line 1322, in wrapper_async
    result = await original_function(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/main.py", line 526, in acompletion
    raise exception_type(
          ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2224, in exception_type
    raise e
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py", line 2062, in exception_type
    raise APIError(
litellm.exceptions.APIError: litellm.APIError: AzureException APIError - 
Traceback (most recent call last):
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 140, in <module>
    main(policy_text, oas_file, os.path.join(args.out_dir,args.step1_dir_name), os.path.join(args.out_dir,args.step2_dir_name), args.run_step1,args.run_step2,args.tools)
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 78, in main
    result = asyncio.run(step2(oas_file, step1_out_dir, step2_out_dir))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/miniconda3/envs/papi/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/__main__.py", line 73, in step2
    return await generate_tools_check_fns("my_app", tool_policies, step2_path, oas_path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 94, in generate_tools_check_fns
    tool_results = await asyncio.gather(*[
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 127, in generate
    tool_check_fn, item_check_fns = self.create_initial_check_fns()
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 259, in create_initial_check_fns
    fn_docstring = fn_doc_string(args, history_arg, api_arg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/naamazwerdling/workspace/policy-fc-validator/src/policy_adherence/gen_tool_policy_check.py", line 52, in fn_doc_string
    app_args_doc = "\n    ".join([f"{arg.arg} ({arg.annotation.id})" for arg in args])
                                                ^^^^^^^^^^^^^^^^^
AttributeError: 'Attribute' object has no attribute 'id'

Process finished with exit code 1
