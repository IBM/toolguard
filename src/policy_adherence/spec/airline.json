{
  "openapi": "3.0.3",
  "info": {
    "title": "TauBench Airline",
    "version": "1.0"
  },
  "servers": [
    {
      "url": "https://api.server.test/v1"
    }
  ],
  "components": {
    "schemas": {
      "User": {
        "type": "object",
        "properties": {
          "name": {
            "type": "object",
            "properties": {
              "first_name": {
                "type": "string"
              },
              "last_name": {
                "type": "string"
              }
            }
          },
          "address": {
            "type": "object",
            "properties": {
              "address1": {
                "type": "string"
              },
              "address2": {
                "type": "string"
              },
              "city": {
                "type": "string"
              },
              "country": {
                "type": "string"
              },
              "province": {
                "type": "string"
              },
              "zip": {
                "type": "string"
              }
            }
          },
          "email": {
            "type": "string"
          },
          "dob": {
            "type": "string",
            "format": "date",
            "description": "Date of birth"
          },
          "payment_methods": {
            "type": "object",
            "additionalProperties": {
              "type": "object",
              "properties": {
                "source": {
                  "type": "string",
                  "enum": [
                    "credit_card",
                    "certificate",
                    "gift_card"
                  ],
                  "description": "Payment method source type."
                },
                "brand": {
                  "type": "string",
                  "description": "Brand of the payment method (e.g., Visa, MasterCard, etc.)."
                },
                "last_four": {
                  "type": "string",
                  "pattern": "^[0-9]{4}$",
                  "description": "Last four digits of the payment method."
                },
                "id": {
                  "type": "string",
                  "description": "Unique identifier for the payment method."
                }
              },
              "required": [
                "source",
                "id"
              ]
            },
            "description": "A collection of payment methods, keyed by unique identifiers."
          },
          "saved_passengers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Passenger"
            }
          },
          "membership": {
            "type": "string",
            "enum": [
              "regular",
              "silver",
              "gold"
            ]
          },
          "reservations": {
            "description": "List of associated reservation ids",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "membership",
          "name",
          "email"
        ]
      },
      "Payment": {
        "type": "object",
        "properties": {
          "payment_id": {
            "type": "string",
            "description": "The payment id stored in user profile, such as 'credit_card_7815826', 'gift_card_7815826', 'certificate_7815826'."
          },
          "amount": {
            "type": "number",
            "description": "The amount to be paid."
          }
        },
        "required": [
          "payment_id",
          "amount"
        ]
      },
      "Passenger": {
        "type": "object",
        "properties": {
          "first_name": {
            "type": "string",
            "description": "The first name of the passenger, such as 'Noah'."
          },
          "last_name": {
            "type": "string",
            "description": "The last name of the passenger, such as 'Brown'."
          },
          "dob": {
            "type": "string",
            "description": "The date of birth of the passenger in the format 'YYYY-MM-DD', such as '1990-01-01'."
          }
        },
        "required": [
          "first_name",
          "last_name",
          "dob"
        ]
      },
      "ScheduledFlight": {
        "type": "object",
        "properties": {
          "flight_number": {
            "type": "string",
            "description": "ScheduledFlight number, such as 'HAT001'."
          },
          "origin": {
            "type": "string",
            "description": "The IATA code for the origin city, such as 'SFO'."
          },
          "destination": {
            "type": "string",
            "description": "The IATA code for the destination city, such as 'JFK'."
          },
          "scheduled_departure_time_est": {
            "type": "string",
            "description": "Estimated scheduled detaprture time in HH:MM:SS format (24-hour clock)."
          },
          "scheduled_arrival_time_est": {
            "type": "string",
            "description": "Estimated scheduled arrival time in HH:MM:SS format (24-hour clock)."
          }
        },
        "required": [
          "flight_number",
          "origin",
          "destination",
          "scheduled_departure_time_est",
          "scheduled_arrival_time_est"
        ]
      },
      "FlightPrices": {
        "type": "object",
        "description": "Price per seat in different classes.",
        "properties": {
          "basic_economy": {
            "type": "number",
            "minimum": 0
          },
          "economy": {
            "type": "number",
            "minimum": 0
          },
          "business": {
            "type": "number",
            "minimum": 0
          }
        }
      },
      "FlightSeats": {
        "type": "object",
        "description": "Number of available seats per class.",
        "properties": {
          "basic_economy": {
            "type": "integer",
            "minimum": 0
          },
          "economy": {
            "type": "integer",
            "minimum": 0
          },
          "business": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "FlightStatus": {
        "type": "string",
        "enum": [
          "landed",
          "available",
          "cancelled",
          "flying"
        ]
      },
      "FlightInstanceId": {
        "type": "object",
        "properties": {
          "flight_number": {
            "type": "string",
            "description": "Flight number, such as 'HAT001'."
          },
          "date": {
            "type": "string",
            "description": "The date for the flight in the format 'YYYY-MM-DD', such as '2024-05-01'."
          }
        },
        "required": [
          "flight_number",
          "date"
        ]
      },
      "FlightInstance": {
        "allOf": [
          {
            "$ref": "#/components/schemas/FlightInstanceId"
          },
          {
            "type": "object",
            "properties": {
              "status": {
                "$ref": "#/components/schemas/FlightStatus"
              },
              "actual_departure_time_est": {
                "type": "string",
                "format": "date-time",
                "description": "Estimated actual departure time in ISO 8601 format (YYYY-MM-DDTHH:MM:SS)."
              },
              "estimated_arrival_time_est": {
                "type": "string",
                "format": "date-time",
                "description": "Estimated arrival time in ISO 8601 format (YYYY-MM-DDTHH:MM:SS)."
              },
              "available_seats": {
                "$ref": "#/components/schemas/FlightSeats"
              },
              "prices": {
                "$ref": "#/components/schemas/FlightPrices"
              }
            },
            "required": [
              "status"
            ]
          }
        ]
      },
      "FoundFlight": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ScheduledFlight"
          },
          {
            "type": "object",
            "properties": {
              "available_seats": {
                "$ref": "#/components/schemas/FlightSeats"
              },
              "prices": {
                "$ref": "#/components/schemas/FlightPrices"
              }
            }
          }
        ],
        "required": [
          "available_seats",
          "prices"
        ]
      },
      "ReservationFlight": {
        "allOf": [
          {
            "$ref": "#/components/schemas/FlightInstanceId"
          },
          {
            "type": "object",
            "properties": {
              "origin": {
                "type": "string",
                "description": "The IATA code for the origin city, such as 'SFO'."
              },
              "destination": {
                "type": "string",
                "description": "The IATA code for the destination city, such as 'JFK'."
              },
              "price": {
                "type": "number",
                "description": "The flight leg"
              }
            }
          }
        ]
      },
      "ReservationBase": {
        "type": "object",
        "properties": {
          "user_id": {
            "type": "string",
            "description": "The ID of the user to book the reservation, such as 'sara_doe_496'."
          },
          "origin": {
            "type": "string",
            "description": "The IATA code for the origin city, such as 'SFO'."
          },
          "destination": {
            "type": "string",
            "description": "The IATA code for the destination city, such as 'JFK'."
          },
          "flight_type": {
            "type": "string",
            "enum": [
              "one_way",
              "round_trip"
            ]
          },
          "cabin": {
            "$ref": "#/components/schemas/Cabin"
          },
          "passengers": {
            "type": "array",
            "description": "An array of objects containing details about each passenger.",
            "items": {
              "$ref": "#/components/schemas/Passenger"
            }
          },
          "total_baggages": {
            "type": "integer",
            "description": "The total number of baggage items included in the reservation."
          },
          "nonfree_baggages": {
            "type": "integer",
            "description": "The number of payed baggage items included in the reservation."
          },
          "insurance": {
            "type": "string",
            "enum": [
              "yes",
              "no"
            ]
          }
        },
        "required": [
          "user_id",
          "origin",
          "destination",
          "flight_type",
          "cabin",
          "passengers",
          "payment_methods",
          "total_baggages",
          "nonfree_baggages",
          "insurance"
        ]
      },
      "CreateReservation": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ReservationBase"
          },
          {
            "type": "object",
            "properties": {
              "flights": {
                "type": "array",
                "description": "flight legs.",
                "items": {
                  "$ref": "#/components/schemas/FlightInstanceId"
                }
              },
              "payment_methods": {
                "type": "array",
                "description": "An array of objects containing details about each payment method.",
                "items": {
                  "$ref": "#/components/schemas/Payment"
                }
              }
            },
            "required": [
              "flights",
              "payment_methods"
            ]
          }
        ]
      },
      "ResevationStatus": {
        "type": "string",
        "enum": [
          "cancelled"
        ]
      },
      "Reservation": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ReservationBase"
          },
          {
            "type": "object",
            "properties": {
              "reservation_id": {
                "type": "string",
                "description": "The reservation ID, such as 'ZFA04Y'."
              },
              "flights": {
                "type": "array",
                "description": "An array of objects containing details about flight legs.",
                "items": {
                  "$ref": "#/components/schemas/ReservationFlight"
                }
              },
              "payment_history": {
                "type": "array",
                "description": "An array of objects containing details about flight legs.",
                "items": {
                  "$ref": "#/components/schemas/Payment"
                }
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the entity was created, in ISO 8601 format."
              },
              "status": {
                "$ref": "#/components/schemas/ResevationStatus"
              }
            },
            "required": [
              "flights",
              "payment_history",
              "created_at"
            ]
          }
        ]
      },
      "Cabin": {
        "type": "string",
        "description": "A cabin",
        "enum": [
          "basic_economy",
          "economy",
          "business"
        ]
      }
    }
  },
  "paths": {
    "/calculate": {
      "get": {
        "operationId": "calculate",
        "description": "Calculate the result of a mathematical expression.",
        "parameters": [
          {
            "name": "expression",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "The mathematical expression to calculate, such as '2 + 2'. The expression can contain numbers, operators (+, -, *, /), parentheses, and spaces.",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/reservations": {
      "post": {
        "operationId": "book_reservation",
        "summary": "Book a reservation.",
        "description": "Creates a reservation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateReservation"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "reservation created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Reservation"
                }
              }
            }
          }
        }
      }
    },
    "/reservations/{reservation_id}": {
      "get": {
        "operationId": "get_reservation_details",
        "description": "Get the reservation.",
        "parameters": [
          {
            "name": "reservation_id",
            "in": "path",
            "schema": {
              "type": "string",
              "description": "The reservation ID, such as 'ZFA04Y'."
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Reservation found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Reservation"
                }
              }
            }
          }
        }
      },
      "delete": {
        "operationId": "cancel_reservation",
        "description": "Cancel the whole reservation.",
        "parameters": [
          {
            "name": "reservation_id",
            "in": "path",
            "schema": {
              "type": "string",
              "description": "The reservation ID, such as 'ZFA04Y'."
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Reservation cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Reservation"
                }
              }
            }
          }
        }
      }
    },
    "/reservations/{reservation_id}/baggages": {
      "put": {
        "operationId": "update_reservation_baggages",
        "description": "Update the baggage information of a reservation.",
        "parameters": [
          {
            "name": "reservation_id",
            "in": "path",
            "schema": {
              "type": "string",
              "description": "The reservation ID, such as 'ZFA04Y'."
            },
            "required": true
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "total_baggages": {
                    "type": "integer",
                    "description": "The total number of baggage items included in the reservation."
                  },
                  "nonfree_baggages": {
                    "type": "integer",
                    "description": "The number of non-free baggage items included in the reservation."
                  },
                  "payment_id": {
                    "type": "string",
                    "description": "The payment id stored in user profile, such as 'credit_card_7815826', 'gift_card_7815826', 'certificate_7815826'."
                  }
                },
                "required": [
                  "total_baggages",
                  "nonfree_baggages",
                  "payment_id"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Update successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Reservation"
                }
              }
            }
          }
        }
      }
    },
    "/reservations/{reservation_id}/flights": {
      "put": {
        "operationId": "update_reservation_flights",
        "description": "Update the flight information of a reservation.",
        "parameters": [
          {
            "name": "reservation_id",
            "in": "path",
            "schema": {
              "type": "string",
              "description": "The reservation ID, such as 'ZFA04Y'."
            },
            "required": true
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "cabin": {
                    "$ref": "#/components/schemas/Cabin"
                  },
                  "flights": {
                    "type": "array",
                    "description": "An array of objects containing details about each flight leg in the ENTIRE new reservation. Even if the a flight segment is not changed, it should still be included in the array.",
                    "items": {
                      "$ref": "#/components/schemas/FlightInstanceId"
                    }
                  },
                  "payment_id": {
                    "type": "string",
                    "description": "The payment id stored in user profile, such as 'credit_card_7815826', 'gift_card_7815826', 'certificate_7815826'."
                  }
                },
                "required": [
                  "cabin",
                  "flights",
                  "payment_id"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Update successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Reservation"
                }
              }
            }
          }
        }
      }
    },
    "/reservations/{reservation_id}/passengers": {
      "put": {
        "operationId": "update_reservation_passengers",
        "description": "Update the passenger information of a reservation.",
        "parameters": [
          {
            "name": "reservation_id",
            "in": "path",
            "schema": {
              "type": "string",
              "description": "The reservation ID, such as 'ZFA04Y'."
            },
            "required": true
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "passengers": {
                    "type": "array",
                    "description": "An array of objects containing details about each flight leg in the ENTIRE new reservation. Even if the a flight segment is not changed, it should still be included in the array.",
                    "items": {
                      "$ref": "#/components/schemas/Passenger"
                    }
                  }
                },
                "required": [
                  "passengers"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Update successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Reservation"
                }
              }
            }
          }
        }
      }
    },
    "/flights/{flight_id}": {
      "get": {
        "operationId": "get_scheduled_flight",
        "description": "Get the details of a scheduled flight. For example, returns the flight origin, destination, scheduled detaprture and arrival times.",
        "parameters": [
          {
            "name": "flight_id",
            "in": "path",
            "schema": {
              "type": "string",
              "description": "The flight id, such as 'HAT001'."
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "The flight",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScheduledFlight"
                }
              }
            }
          }
        }
      }
    },
    "/flights/direct": {
      "get": {
        "operationId": "search_direct_flight",
        "description": "Search direct flights between two cities on a specific date.",
        "parameters": [
          {
            "name": "origin",
            "in": "query",
            "description": "The origin city airport in three letters, such as 'JFK'.",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "destination",
            "in": "query",
            "description": "The destination city airport in three letters, such as 'LAX'.",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "date",
            "in": "query",
            "description": "The date of the flight in the format 'YYYY-MM-DD', such as '2024-01-01'.",
            "schema": {
              "type": "string",
              "format": "date"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Available flights found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FoundFlight"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/flights/one_stop": {
      "get": {
        "operationId": "search_onestop_flight",
        "description": "Search one-stop flights between two cities on a specific date.",
        "parameters": [
          {
            "name": "origin",
            "in": "query",
            "description": "The origin city airport in three letters, such as 'JFK'.",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "destination",
            "in": "query",
            "description": "The destination city airport in three letters, such as 'LAX'.",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "date",
            "in": "query",
            "description": "The date of the flight in the format 'YYYY-MM-DD', such as '2024-01-01'.",
            "schema": {
              "type": "string",
              "format": "date"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Available flights found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "array",
                    "items": {
                      "$ref": "#/components/schemas/FoundFlight"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/flights/{flight_id}/{date}": {
      "get": {
        "operationId": "get_flight_instance",
        "description": "Get the details of a flight instance in a specific date. For example, returns the flight status, available seats and prices.",
        "parameters": [
          {
            "name": "flight_id",
            "in": "path",
            "description": "The flight id, such as 'HAT001'.",
            "schema": {
              "type": "string"
            },
            "required": true
          },
          {
            "name": "date",
            "in": "path",
            "description": "The date of the flight, such as '2024-05-02'.",
            "schema": {
              "type": "string",
              "format": "date"
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "The flight",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FlightInstance"
                }
              }
            }
          }
        }
      }
    },
    "/airports": {
      "get": {
        "operationId": "list_all_airports",
        "description": "List all airports available in the system",
        "responses": {
          "200": {
            "description": "The flight",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/users/{user_id}": {
      "get": {
        "operationId": "get_user_details",
        "description": "Get the details of an user.",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "The user id, such as 'sara_doe_496'.",
            "schema": {
              "type": "string"
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "The user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          }
        }
      }
    },
    "/users/{user_id}/certificate": {
      "put": {
        "operationId": "send_certificate",
        "description": "Send a certificate to a user. Be careful!",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "The user id, such as 'sara_doe_496'.",
            "schema": {
              "type": "string"
            },
            "required": true
          },
          {
            "name": "amount",
            "in": "query",
            "description": "Certificate amount to send.",
            "schema": {
              "type": "number"
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "The user",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/think": {
      "post": {
        "operationId": "think",
        "description": "Use the tool to think about something. It will not obtain new information or change the database, but just append the thought to the log. Use it when complex reasoning is needed.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "thought": {
                    "type": "string",
                    "description": "A thought to think about."
                  }
                },
                "required": [
                  "thought"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The user",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/transfer_to_human": {
      "post": {
        "operationId": "transfer_to_human_agents",
        "description": "Transfer the user to a human agent, with a summary of the user's issue. Only transfer if the user explicitly asks for a human agent, or if the user's issue cannot be resolved by the agent with the available tools.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "summary": {
                    "type": "string",
                    "description": "A summary of the user's issue."
                  }
                },
                "required": [
                  "summary"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The user",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    }
  }
}
